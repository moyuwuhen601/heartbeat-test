<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒè·³æµ‹è¯•</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
            margin-top: 50px;
        }
        button {
            font-size: 20px;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
        }
        #bpm {
            font-size: 24px;
            font-weight: bold;
            color: red;
        }
    </style>
</head>
<body>

    <h1>å¿ƒè·³æµ‹è¯•</h1>
    <p>ç‚¹å‡»é¼ æ ‡ æˆ– æŒ‰ä¸‹ <b>ç©ºæ ¼é”®</b> è®°å½•å¿ƒè·³</p>
    <button id="heartbeatBtn">ç‚¹æˆ‘è®°å½•å¿ƒè·³</button>
    <button id="resetBtn">é‡ç½®</button> <!-- ğŸ”„ æ–°å¢é‡ç½®æŒ‰é’® -->
    <p>å·²è®°å½•å¿ƒè·³æ¬¡æ•°ï¼š<span id="count">0</span></p>
    <p id="timer">å€’è®¡æ—¶ï¼š60 ç§’</p>
    <p>ä½ çš„å¿ƒç‡ï¼ˆBPMï¼‰ï¼š<span id="bpm">--</span></p>
    <p style="color: red;">ä»…ä¾›å¨±ä¹æµ‹è¯•ï¼Œå¦‚é‡ä¸é€‚è¯·åŠæ—¶çº¿ä¸‹å°±åŒ»</p>

    <script>
        let count = 0;       // è®°å½•å¿ƒè·³æ¬¡æ•°
        let startTime = null; // è®¡æ—¶å™¨å¼€å§‹æ—¶é—´
        let timer = 60;      // å€’è®¡æ—¶ç§’æ•°
        let interval;        // å®šæ—¶å™¨

        function recordHeartbeat() {
            if (!startTime) {
                startTime = Date.now(); // è®°å½•å¼€å§‹æ—¶é—´
                interval = setInterval(updateTimer, 1000); // å¯åŠ¨å€’è®¡æ—¶
            }
            count++;
            document.getElementById("count").innerText = count;
        }

        function updateTimer() {
            if (timer > 0) {
                timer--;
                document.getElementById("timer").innerText = `å€’è®¡æ—¶ï¼š${timer} ç§’`;
            } else {
                clearInterval(interval);
                let bpm = Math.round((count / 60) * 60); // è®¡ç®— BPM
                document.getElementById("bpm").innerText = bpm;
                document.getElementById("heartbeatBtn").disabled = true; // ç¦ç”¨æŒ‰é’®
            }
        }

        function resetTest() {
            clearInterval(interval);
            count = 0;
            startTime = null;
            timer = 60;
            document.getElementById("count").innerText = count;
            document.getElementById("timer").innerText = `å€’è®¡æ—¶ï¼š60 ç§’`;
            document.getElementById("bpm").innerText = "--";
            document.getElementById("heartbeatBtn").disabled = false;
        }

        // ç›‘å¬é¼ æ ‡ç‚¹å‡»
        document.getElementById("heartbeatBtn").addEventListener("click", recordHeartbeat);

        // ç›‘å¬é”®ç›˜ç©ºæ ¼é”®
        document.addEventListener("keydown", function(event) {
            if (event.code === "Space") {
                event.preventDefault(); // é˜²æ­¢é¡µé¢æ»šåŠ¨
                recordHeartbeat();
            }
        });

        // ç›‘å¬é‡ç½®æŒ‰é’®
        document.getElementById("resetBtn").addEventListener("click", resetTest);

    </script>

</body>
</html>
